<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SentinelGate Demo — Without Script (Unprotected)</title>
  <!-- NO script here - inject and see DB data -->
  <style>
    * { box-sizing: border-box; }
    body { font-family: system-ui, sans-serif; max-width: 680px; margin: 0 auto; padding: 24px; background: #0a0a0a; color: #e5e5e5; min-height: 100vh; }
    h1 { font-size: 1.5rem; color: #D9FF00; }
    .nav { margin-bottom: 20px; }
    .nav a { color: #888; text-decoration: none; margin-right: 16px; }
    .nav a.active { color: #ff6b6b; }
    .nav a:hover { color: #fff; }
    .badge { display: inline-block; background: #FF3E3E20; color: #ff6b6b; padding: 4px 10px; border-radius: 20px; font-size: 0.85rem; margin-bottom: 16px; }
    .instructions { background: #171717; border: 1px solid #333; border-radius: 12px; padding: 16px; margin-bottom: 20px; font-size: 0.9rem; }
    .chat-container { border: 1px solid #333; border-radius: 12px; overflow: hidden; background: #171717; }
    .chat-messages { height: 260px; overflow-y: auto; padding: 16px; font-size: 0.9rem; }
    .msg { margin-bottom: 12px; padding: 10px 14px; border-radius: 8px; max-width: 90%; word-break: break-word; }
    .msg.user { background: #D9FF0020; margin-left: auto; border: 1px solid #D9FF0040; }
    .msg.bot { background: #262626; border: 1px solid #333; white-space: pre-wrap; }
    .msg.leaked { background: #FF3E3E15; border: 1px solid #FF3E3E60; color: #ffa94d; }
    .chat-form { display: flex; gap: 8px; padding: 12px; border-top: 1px solid #333; }
    .chat-form input { flex: 1; padding: 12px 16px; border: 1px solid #444; border-radius: 8px; background: #0a0a0a; color: #fff; font-size: 1rem; }
    .chat-form input:focus { outline: none; border-color: #D9FF00; }
    .chat-form button { padding: 12px 20px; background: #D9FF00; color: #0a0a0a; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; }
    .test-section { padding: 12px 16px; border-top: 1px solid #333; }
    .test-cases { margin-top: 8px; display: flex; flex-wrap: wrap; gap: 8px; }
    .test-cases button { padding: 6px 12px; background: #262626; border: 1px solid #444; border-radius: 6px; color: #ccc; font-size: 0.8rem; cursor: pointer; }
    .test-cases button:hover { border-color: #D9FF00; color: #fff; }
  </style>
</head>
<body>
  <h1>SentinelGate Demo</h1>
  <div class="nav">
    <a href="/">With script</a>
    <a href="/no-script.html" class="active">Without script</a>
  </div>
  <span class="badge">No script — injections reach DB</span>

  <div class="instructions">
    <b>Without script:</b> Try SQL injection below — you will see <b>DB data leaked</b>. Same page, just no script tag.
  </div>

  <div class="chat-container">
    <div class="chat-messages" id="messages">
      <div class="msg bot">Try any injection below — DB data will be returned.</div>
    </div>
    <form class="chat-form" id="chatForm">
      <input type="text" id="chatInput" placeholder="Type or use buttons below..." autocomplete="off" />
      <button type="submit">Send</button>
    </form>
    <div class="test-section">
      <strong>Quick test:</strong>
      <div class="test-cases">
        <button type="button" data-msg="' OR 1=1 --">' OR 1=1 --</button>
        <button type="button" data-msg="Admin' OR '1'='1">Admin' OR '1'='1</button>
        <button type="button" data-msg="1; DROP TABLE users;--">1; DROP TABLE users;--</button>
        <button type="button" data-msg="UNION SELECT * FROM secrets">UNION SELECT * FROM secrets</button>
        <button type="button" data-msg="get Admin">get Admin</button>
        <button type="button" data-msg="Hello">Hello</button>
      </div>
    </div>
  </div>

  <script>
    var form = document.getElementById('chatForm');
    var input = document.getElementById('chatInput');
    var messagesEl = document.getElementById('messages');

    function addMsg(text, type) {
      var div = document.createElement('div');
      div.className = 'msg ' + type;
      div.textContent = text;
      messagesEl.appendChild(div);
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    form.addEventListener('submit', function(e) {
      e.preventDefault();
      var text = input.value.trim();
      if (!text) return;
      addMsg(text, 'user');
      input.value = '';

      fetch('/chat/unsecured', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: text })
      }).then(function(r) { return r.json(); }).then(function(d) {
        addMsg(d.response || d.message || 'OK', d.is_injection ? 'leaked' : 'bot');
      }).catch(function(err) {
        addMsg('Error: ' + (err.message || ''), 'bot');
      });
    });

    document.querySelectorAll('.test-cases button').forEach(function(btn) {
      btn.addEventListener('click', function() { input.value = btn.dataset.msg; input.focus(); });
    });
  </script>
</body>
</html>
